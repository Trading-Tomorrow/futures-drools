package rules

dialect "java"

import org.futures.model.Sentiment;
import org.futures.model.PartialSignal;

// ğŸŸ¢ Positive alignment (both positive â†’ bullish)
rule "Bullish - Positive sentiment alignment"
when
    $b : Sentiment(source == "Bloomberg", tone == "positive", intensity > 0.7)
    $t : Sentiment(source == "Twitter", tone == "positive", intensity > 0.6, month == $b.getMonth())
then
    String monthLabel = $b.getMonth() > 0 ? String.valueOf($b.getMonth()) : "CURRENT";
    insert(new PartialSignal("sentiment", "BUY", 0.8, monthLabel));
    System.out.println("ğŸ—ï¸ Sentiment â†’ Both positive (" + monthLabel +
        ") â†’ bullish bias. Bloomberg=" + $b.getIntensity() + ", Twitter=" + $t.getIntensity());
end

// ğŸ”´ Negative alignment (both negative â†’ bearish)
rule "Bearish - Negative sentiment alignment"
when
    $b : Sentiment(source == "Bloomberg", tone == "negative", intensity > 0.7)
    $t : Sentiment(source == "Twitter", tone == "negative", intensity > 0.6, month == $b.getMonth())
then
    String monthLabel = $b.getMonth() > 0 ? String.valueOf($b.getMonth()) : "CURRENT";
    insert(new PartialSignal("sentiment", "SELL", 0.8, monthLabel));
    System.out.println("ğŸ—ï¸ Sentiment â†’ Both negative (" + monthLabel +
        ") â†’ bearish bias. Bloomberg=" + $b.getIntensity() + ", Twitter=" + $t.getIntensity());
end

// âšª Mixed or contradictory sentiment â†’ neutral
rule "Neutral - Mixed sentiment"
when
    $b : Sentiment(source == "Bloomberg")
    $t : Sentiment(source == "Twitter", month == $b.getMonth())
    eval(!$b.getTone().equals($t.getTone()))
then
    String monthLabel = $b.getMonth() > 0 ? String.valueOf($b.getMonth()) : "CURRENT";
    insert(new PartialSignal("sentiment", "HOLD", 0.5, monthLabel));
    System.out.println("ğŸ—ï¸ Sentiment â†’ Mixed perception (" + monthLabel +
        ") â†’ neutral stance. Bloomberg=" + $b.getTone() + ", Twitter=" + $t.getTone());
end
