package rules

dialect "java"

import org.futures.model.Weather;
import org.futures.model.Commodity;
import org.futures.model.Hypothesis;
import org.futures.model.PartialSignal
import java.util.Map
import java.util.HashMap;

//Drought or excessive heat ‚Üí bullish (bad harvest risk)
rule "Bullish (Drought or heatwave) - Brasil Arabica"
    agenda-group "arabica"
when
    $commodity :Commodity(name=="Arabica")
    $w : Weather(country=="Brasil",month==$commodity.getMonth())
    eval($w.getTemperature() > 24 && $w.getSpi()<=-1)
then
    double confidence=0.0;
    switch($w.getRegion()){
        case "Minas Gerais": confidence=0.8;break;
        case "S√£o Paulo": confidence=0.8;break;
        case "Bahia": confidence=0.8;break;
    }

    Map<String, Object> factors = new HashMap<>();
    factors.put("month", $commodity.getMonth());
    factors.put("temperature", $w.getTemperature());
    factors.put("country", $w.getCountry());
    factors.put("spi", $w.getSpi());

    insert(new Hypothesis($commodity.getName(),"Drought or heatwave",factors,confidence,"BUY"));
    System.out.println("‚òÄÔ∏è Drought/heatwave ‚Üí bullish ("+ $w.getRegion() + ", Temperature=" + $w.getTemperature()+ "¬∞C,SPI="+$w.getSpi()+ " month=" + $w.getMonth() + ")");
end

rule "Bullish (Drought or heatwave) - Colombia Arabica"
    agenda-group "arabica"
when
    $commodity :Commodity(name=="Arabica")
    $w : Weather(country=="Colombia",month==$commodity.getMonth())
    eval($w.getTemperature() > 24 && $w.getSpi()<=-1)
then
    double confidence=0.0;
    switch($w.getRegion()){
        case "Andina Cafeeira" : confidence=0.80;break;
    }

    Map<String, Object> factors = new HashMap<>();
    factors.put("month", $commodity.getMonth());
    factors.put("temperature", $w.getTemperature());
    factors.put("country", $w.getCountry());
    factors.put("spi", $w.getSpi());

    insert(new Hypothesis($commodity.getName(),"Drought or heatwave",factors,confidence,"BUY"));
    System.out.println("‚òÄÔ∏è Drought/heatwave ‚Üí bullish ("+ $w.getRegion() + ", Temperature=" + $w.getTemperature()+ "¬∞C,SPI="+$w.getSpi()+ " month=" + $w.getMonth() + ")");
end

rule "Bullish (Drought or heatwave) - Brasil Robusta"
    agenda-group "robusta"
when
    $commodity :Commodity(name=="Robusta")
    $w : Weather(country=="Brasil",month==$commodity.getMonth())
    eval($w.getTemperature() > 33 && $w.getSpi()<=-1)
then
    double confidence=0.0;
    switch($w.getRegion()){
        case "Espirito Santo": confidence=0.8;break;
    }

    Map<String, Object> factors = new HashMap<>();
    factors.put("month", $commodity.getMonth());
    factors.put("temperature", $w.getTemperature());
    factors.put("country", $w.getCountry());
    factors.put("spi", $w.getSpi());

    insert(new Hypothesis($commodity.getName(),"Drought or heatwave",factors,confidence,"BUY"));
    System.out.println("‚òÄÔ∏è Drought/heatwave ‚Üí bullish ("+ $w.getRegion() + ", Temperature=" + $w.getTemperature()+ "¬∞C,SPI="+$w.getSpi()+ " month=" + $w.getMonth() + ")");
end

rule "Bullish (Drought or heatwave) - Vietnam Robusta"
    agenda-group "robusta"
when
   $commodity :Commodity(name=="Robusta")
   $w : Weather(country=="Vietnam",month==$commodity.getMonth())
   eval($w.getTemperature() > 33 && $w.getSpi()<=-1)
then
    double confidence=0.0;
   switch($w.getRegion()){
       case "Central Highlands": confidence=0.8;break;
   }

   Map<String, Object> factors = new HashMap<>();
   factors.put("month", $commodity.getMonth());
   factors.put("country", $w.getCountry());
   factors.put("temperature", $w.getTemperature());
   factors.put("spi", $w.getSpi());

   insert(new Hypothesis($commodity.getName(),"Drought or heatwave",factors,confidence,"BUY"));
   System.out.println("‚òÄÔ∏è Drought/heatwave ‚Üí bullish ("+ $w.getRegion() + ", Temperature=" + $w.getTemperature()+ "¬∞C,SPI="+$w.getSpi()+ " month=" + $w.getMonth() + ")");
end



// üå§Ô∏è Ideal conditions ‚Üí neutral

rule "Neutral Ideal conditions - Brasil Arabica"
    agenda-group "arabica"
when
    $commodity :Commodity(name=="Arabica")
    $w : Weather(country=="Brasil",month==$commodity.getMonth())
    eval(18<=$w.getTemperature() && $w.getTemperature()<=24 && -1<$w.getSpi() && $w.getSpi()<1)
then
    double confidence=0.0;
    switch($w.getRegion()){
        case "Minas Gerais": confidence=0.8;break;
        case "S√£o Paulo": confidence=0.8;break;
        case "Bahia": confidence=0.8;break;
    }

    Map<String, Object> factors = new HashMap<>();
    factors.put("month", $commodity.getMonth());
    factors.put("temperature", $w.getTemperature());
    factors.put("country", $w.getCountry());
    factors.put("spi", $w.getSpi());


   insert(new Hypothesis($commodity.getName(),"Ideal weather",factors,confidence,"HOLD"));
   System.out.println("üå§Ô∏è Ideal weather ‚Üí neutral ("+ $w.getRegion() + ", month=" + $commodity.getMonth() + ")");

end

rule "Neutral Ideal conditions - Colombia Arabica"
    agenda-group "arabica"
when
    $commodity :Commodity(name=="Arabica")
    $w : Weather(country=="Colombia",month==$commodity.getMonth())
    eval(18<= $w.getTemperature() && $w.getTemperature()<=24 && -1<$w.getSpi() && $w.getSpi()<1)
then
    double confidence=0.0;
    switch($w.getRegion()){
        case "Andina Cafeeira" : confidence=0.80;break;
    }

    Map<String, Object> factors = new HashMap<>();
    factors.put("month", $commodity.getMonth());
    factors.put("temperature", $w.getTemperature());
    factors.put("country", $w.getCountry());
    factors.put("spi", $w.getSpi());


   insert(new Hypothesis($commodity.getName(),"Ideal weather",factors,confidence,"HOLD"));
   System.out.println("üå§Ô∏è Ideal weather ‚Üí neutral ("+ $w.getRegion() + ", month=" + $commodity.getMonth() + ")");
end

rule "Neutral Ideal conditions - Brasil Robusta"
    agenda-group "robusta"
when
    $commodity :Commodity(name=="Robusta")
    $w : Weather(country=="Brasil",month==$commodity.getMonth())
    eval(24<=$w.getTemperature() && $w.getTemperature()<=33 && -1<$w.getSpi() && $w.getSpi()<1)
then
    double confidence=0.0;
    switch($w.getRegion()){
        case "Espirito Santo": confidence=0.8;break;
    }

    Map<String, Object> factors = new HashMap<>();
    factors.put("month", $commodity.getMonth());
    factors.put("temperature", $w.getTemperature());
    factors.put("country", $w.getCountry());
    factors.put("spi", $w.getSpi());

   insert(new Hypothesis($commodity.getName(),"Ideal weather",factors,confidence,"HOLD"));
   System.out.println("üå§Ô∏è Ideal weather ‚Üí neutral ("+ $w.getRegion() + ", month=" + $commodity.getMonth() + ")");
end

rule "Neutral Ideal conditions - Vietnam Robusta"
    agenda-group "robusta"
when
   $commodity :Commodity(name=="Robusta")
   $w : Weather(country=="Vietnam",month==$commodity.getMonth())
    eval(24<=$w.getTemperature() && $w.getTemperature()<=33 && -1<$w.getSpi() && $w.getSpi()<1)
then
    double confidence=0.0;
   switch($w.getRegion()){
       case "Central Highlands": confidence=0.8;break;
   }

   Map<String, Object> factors = new HashMap<>();
   factors.put("month", $commodity.getMonth());
   factors.put("country", $w.getCountry());
   factors.put("temperature", $w.getTemperature());
   factors.put("spi", $w.getSpi());

   insert(new Hypothesis($commodity.getName(),"Ideal weather",factors,confidence,"HOLD"));
   System.out.println("üå§Ô∏è Ideal weather ‚Üí neutral ("+ $w.getRegion() + ", month=" + $commodity.getMonth() + ")");
end

// üå§Ô∏è Non-Ideal conditions ‚Üí neutral

rule "Non-Ideal conditions - Brasil Arabica"
    agenda-group "arabica"
when
    $commodity :Commodity(name=="Arabica")
    $w : Weather(country=="Brasil",month==$commodity.getMonth())
    eval(!(($w.getTemperature() > 24 && $w.getSpi()<=-1) || (18<=$w.getTemperature() && $w.getTemperature()<=24 && -1<$w.getSpi() && $w.getSpi()<1)))
then
    double confidence=0.0;
    switch($w.getRegion()){
        case "Minas Gerais": confidence=0.8;break;
        case "S√£o Paulo": confidence=0.8;break;
        case "Bahia": confidence=0.8;break;
    }

    Map<String, Object> factors = new HashMap<>();
    factors.put("month", $commodity.getMonth());
    factors.put("temperature", $w.getTemperature());
    factors.put("country", $w.getCountry());
    factors.put("spi", $w.getSpi());


   insert(new Hypothesis($commodity.getName(),"Non-Ideal weather",factors,confidence,"BUY"));
   System.out.println("üå§Ô∏è Non-Ideal weather ‚Üí ("+ $w.getRegion() + ", month=" + $commodity.getMonth() + ")");

end

rule "Non-Ideal conditions - Colombia Arabica"
    agenda-group "arabica"
when
    $commodity :Commodity(name=="Arabica")
    $w : Weather(country=="Colombia",month==$commodity.getMonth())
    eval(!(($w.getTemperature() > 24 && $w.getSpi()<=-1) || (18<=$w.getTemperature() && $w.getTemperature()<=24 && -1<$w.getSpi() && $w.getSpi()<1)))
then
    double confidence=0.0;
    switch($w.getRegion()){
        case "Andina Cafeeira" : confidence=0.80;break;
    }

    Map<String, Object> factors = new HashMap<>();
    factors.put("month", $commodity.getMonth());
    factors.put("temperature", $w.getTemperature());
    factors.put("country", $w.getCountry());
    factors.put("spi", $w.getSpi());


   insert(new Hypothesis($commodity.getName(),"Non-Ideal weather",factors,confidence,"BUY"));
   System.out.println("üå§Ô∏è Non-Ideal weather ‚Üí ("+ $w.getRegion() + ", month=" + $commodity.getMonth() + ")");
end

rule "Non-Ideal conditions - Brasil Robusta"
    agenda-group "robusta"
when
    $commodity :Commodity(name=="Robusta")
    $w : Weather(country=="Brasil",month==$commodity.getMonth())
    eval(!(($w.getTemperature() > 33 && $w.getSpi()<=-1) || (24<= $w.getTemperature() && $w.getTemperature()<=33 && -1<$w.getSpi() && $w.getSpi()<1)))
then
    double confidence=0.0;
    switch($w.getRegion()){
        case "Espirito Santo": confidence=0.8;break;
    }

    Map<String, Object> factors = new HashMap<>();
    factors.put("month", $commodity.getMonth());
    factors.put("temperature", $w.getTemperature());
    factors.put("country", $w.getCountry());
    factors.put("spi", $w.getSpi());

   insert(new Hypothesis($commodity.getName(),"Non-Ideal weather",factors,confidence,"BUY"));
   System.out.println("üå§Ô∏è Non-Ideal weather ‚Üí ("+ $w.getRegion() + ", month=" + $commodity.getMonth() + ")");
end

rule "Non-Ideal conditions - Vietnam Robusta"
    agenda-group "robusta"
when
   $commodity :Commodity(name=="Robusta")
   $w : Weather(country=="Vietnam",month==$commodity.getMonth())
    eval(!(($w.getTemperature() > 33 && $w.getSpi()<=-1) || (24<=$w.getTemperature() && $w.getTemperature()<=33 && -1<$w.getSpi() && $w.getSpi()<1)))
then
    double confidence=0.0;
   switch($w.getRegion()){
       case "Central Highlands": confidence=0.8;break;
   }

   Map<String, Object> factors = new HashMap<>();
   factors.put("month", $commodity.getMonth());
   factors.put("country", $w.getCountry());
   factors.put("temperature", $w.getTemperature());
   factors.put("spi", $w.getSpi());

   insert(new Hypothesis($commodity.getName(),"Non-Ideal weather",factors,confidence,"BUY"));
   System.out.println("üå§Ô∏è Non-Ideal weather ‚Üí ("+ $w.getRegion() + ", month=" + $commodity.getMonth() + ")");
end


