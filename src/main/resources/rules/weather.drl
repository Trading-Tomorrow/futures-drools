package rules

dialect "java"

import org.futures.model.Weather;
import org.futures.model.PartialSignal;

// â˜€ï¸ Drought or excessive heat â†’ bullish (bad harvest risk)
rule "Bullish - Drought or heatwave"
when
    $w : Weather(condition == "drought" || temperatureDeviation > 2)
then
    String monthLabel = $w.getMonth() > 0 ? String.valueOf($w.getMonth()) : "CURRENT";
    insert(new PartialSignal("weather", "BUY", 0.8, monthLabel));
    System.out.println("â˜€ï¸ Drought/heatwave â†’ bullish ("
        + $w.getRegion() + ", Î”T=" + $w.getTemperatureDeviation()
        + "Â°C, month=" + monthLabel + ")");
end

// â„ï¸ Frost â†’ bullish (crop loss risk)
rule "Bullish - Frost conditions"
when
    $w : Weather(condition == "frost" || temperatureDeviation < -2)
then
    String monthLabel = $w.getMonth() > 0 ? String.valueOf($w.getMonth()) : "CURRENT";
    insert(new PartialSignal("weather", "BUY", 0.9, monthLabel));
    System.out.println("â„ï¸ Frost â†’ bullish ("
        + $w.getRegion() + ", Î”T=" + $w.getTemperatureDeviation()
        + "Â°C, month=" + monthLabel + ")");
end

// ğŸŒ§ï¸ Excess rain â†’ bearish (better yields expected)
rule "Bearish - Excess rain"
when
    $w : Weather(condition == "rain" && precipitationDeviation > 30)
then
    String monthLabel = $w.getMonth() > 0 ? String.valueOf($w.getMonth()) : "CURRENT";
    insert(new PartialSignal("weather", "SELL", 0.7, monthLabel));
    System.out.println("ğŸŒ§ï¸ Excess rain â†’ bearish ("
        + $w.getRegion() + ", Î”Rain=" + $w.getPrecipitationDeviation()
        + "%, month=" + monthLabel + ")");
end

// ğŸŒ¤ï¸ Ideal conditions â†’ neutral
rule "Neutral - Ideal conditions"
when
    $w : Weather(condition == "ideal")
then
    String monthLabel = $w.getMonth() > 0 ? String.valueOf($w.getMonth()) : "CURRENT";
    insert(new PartialSignal("weather", "HOLD", 0.5, monthLabel));
    System.out.println("ğŸŒ¤ï¸ Ideal weather â†’ neutral ("
        + $w.getRegion() + ", month=" + monthLabel + ")");
end
